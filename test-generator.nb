(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9935,        242]
NotebookOptionsPosition[      9237,        216]
NotebookOutlinePosition[      9583,        231]
CellTagsIndexPosition[      9540,        228]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"n", ":=", 
  RowBox[{"Length", "[", "\[Lambda]", "]"}]}]], "Input",
 CellChangeTimes->{{3.667154672528908*^9, 3.667154692544406*^9}}],

Cell[BoxData[
 RowBox[{"\:041b", " ", ":=", " ", 
  RowBox[{"DiagonalMatrix", "[", "\[Lambda]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6563262683873444`*^9, 3.6563262727866635`*^9}, {
   3.6563263353455133`*^9, 3.6563263601108446`*^9}, 3.656327157821607*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "100"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665065869763241*^9, 3.665065943414589*^9}, {
   3.6650669702278137`*^9, 3.6650669839135475`*^9}, {3.6650670598189125`*^9, 
   3.665067076114956*^9}, {3.66506711696214*^9, 3.6650671513355045`*^9}, 
   3.6650672694474955`*^9, {3.6650674198015804`*^9, 3.6650674613988614`*^9}, {
   3.6650681959545374`*^9, 3.665068238965996*^9}, {3.6650688196746707`*^9, 
   3.665068823950214*^9}, {3.6653886429678907`*^9, 3.6653886452612047`*^9}, {
   3.6653887847888613`*^9, 3.6653887870507755`*^9}, {3.6671547050299664`*^9, 
   3.667154708144351*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"61", ",", "81", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"84", ",", "2", ",", "48"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"59", ",", "87", ",", "68"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.665067270180588*^9, 3.665067366487813*^9}, {
   3.6650674064528856`*^9, 3.6650674721462255`*^9}, {3.6650675647129745`*^9, 
   3.6650675903152237`*^9}, 3.6650680318006988`*^9, {3.665068209488254*^9, 
   3.6650682414543104`*^9}, 3.6650684831939955`*^9, {3.665068634798205*^9, 
   3.6650686633828344`*^9}, {3.665068774496938*^9, 3.665068839710215*^9}, 
   3.6653342465340843`*^9, {3.6653364707859187`*^9, 3.665336491286487*^9}, 
   3.66533719419057*^9, 3.6653373273671494`*^9, 3.665337491633733*^9, 
   3.6653375434052544`*^9, {3.665338612269163*^9, 3.665338627119022*^9}, 
   3.665338659917133*^9, 3.6653390001917734`*^9, 3.665340287127042*^9, 
   3.6653403730566177`*^9, 3.66538844231769*^9, 3.6653886572108154`*^9, 
   3.6653888158018346`*^9, 3.6659455506458063`*^9, 3.6659924466510553`*^9, 
   3.6659925708606033`*^9, 3.665992859697172*^9, 3.6659932701679516`*^9, 
   3.666545605050625*^9, 3.6671518762152233`*^9, 3.6671539233601747`*^9, 
   3.6671541017934003`*^9, 3.6671543118769073`*^9, {3.6671544218766346`*^9, 
   3.6671544415650883`*^9}, 3.667154850109068*^9, 3.66715493606079*^9, 
   3.667155050588098*^9, 3.667155660935233*^9, 3.6671558483542604`*^9, 
   3.6671559196431527`*^9, 3.6671560559751844`*^9, 3.667156131511588*^9, 
   3.6671561944244375`*^9, {3.6671562825314293`*^9, 3.667156293968857*^9}, 
   3.667156566940219*^9, 3.6671568199457884`*^9, 3.6672031242400956`*^9, 
   3.667203375046282*^9, 3.6672034453248672`*^9, 3.667751365201184*^9, {
   3.6677577823287477`*^9, 3.6677578046645355`*^9}, 3.667758051053286*^9, 
   3.6677583594747615`*^9, 3.6677586540835185`*^9, 3.6677590615563602`*^9, 
   3.66775938831213*^9, 3.667759878188255*^9, 3.6677602007574997`*^9, 
   3.667760611522752*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lineSum", " ", ":=", " ", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lineSum", " ", "=", " ", 
       RowBox[{"lineSum", " ", "+", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], "]"}]}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"lineSum", " ", "+", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "n"}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6650659673256245`*^9, 3.665065976429784*^9}, {
  3.6650660690305347`*^9, 3.6650660775156116`*^9}, {3.6650662263475018`*^9, 
  3.6650662698120213`*^9}, {3.665066332155933*^9, 3.665066525989423*^9}, {
  3.665066557099374*^9, 3.665066607424759*^9}, {3.665066645780628*^9, 
  3.6650666702847395`*^9}, {3.6650673124389544`*^9, 3.6650673190697947`*^9}, {
  3.6650687583088818`*^9, 3.6650687718195972`*^9}, {3.665068814631033*^9, 
  3.6650688167202983`*^9}, {3.66538867023704*^9, 3.665388674261775*^9}, {
  3.6653887955996523`*^9, 3.665388800810074*^9}, {3.667154734035581*^9, 
  3.667154749624527*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"B", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ".", 
   RowBox[{"t", "[", "j", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "[", "i_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"B", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], " ", "-", " ", 
   RowBox[{
    SubsuperscriptBox["\[Sum]", 
     RowBox[{"j", "=", "1"}], 
     RowBox[{"i", "-", "1"}]], 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "*", 
     RowBox[{"t", "[", "j", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6650637385671196`*^9, 3.6650637448479156`*^9}, {
  3.665063906142393*^9, 3.6650639442312236`*^9}, {3.6650639853734493`*^9, 
  3.665064079078231*^9}, {3.6650641136386166`*^9, 3.665064152884598*^9}, {
  3.6650641970502415`*^9, 3.6650641996365323`*^9}, {3.6650642651458497`*^9, 
  3.665064266346002*^9}, {3.66506429825705*^9, 3.665064300874382*^9}, {
  3.6650645362862635`*^9, 3.665064542367062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "[", "i_", "]"}], " ", ":=", " ", 
  RowBox[{"N", "[", 
   FractionBox[
    RowBox[{"v", "[", "i", "]"}], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"v", "[", "i", "]"}], ".", 
      RowBox[{"v", "[", "i", "]"}]}], "]"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.665063670946538*^9, 3.665063701586426*^9}, {
  3.665063822283745*^9, 3.665063836710577*^9}, {3.665064490187413*^9, 
  3.6650645020829225`*^9}, {3.6650646258336325`*^9, 3.6650646306612434`*^9}, {
  3.665068729120177*^9, 3.6650687407796593`*^9}, {3.6653887261010303`*^9, 
  3.665388730718773*^9}}],

Cell[BoxData[
 RowBox[{"TT", " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"t", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6650646691643896`*^9, 3.665064674345045*^9}, {
   3.6650647670028057`*^9, 3.665064774222723*^9}, {3.6650648204345903`*^9, 
   3.6650648220958014`*^9}, {3.665064894248957*^9, 3.665064916049724*^9}, 
   3.6650649652069645`*^9, {3.665388700392007*^9, 3.6653887009380064`*^9}, {
   3.665388807986102*^9, 3.665388808142104*^9}, {3.667154764848426*^9, 
   3.667154765187475*^9}}],

Cell[BoxData[
 RowBox[{"T", " ", ":=", " ", 
  RowBox[{"Transpose", "[", "TT", "]"}]}]], "Input",
 CellChangeTimes->{
  3.665064801676236*^9, {3.6650649698645573`*^9, 3.6650649752792425`*^9}}],

Cell[BoxData[
 RowBox[{"A", " ", ":=", " ", 
  RowBox[{"T", ".", "\:041b", ".", 
   RowBox[{"Transpose", "[", "T", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6563266383094206`*^9, 3.656326647265911*^9}, {
  3.6563267459803853`*^9, 3.6563267656218643`*^9}, {3.65632682143484*^9, 
  3.6563268265481167`*^9}, {3.6650618355106907`*^9, 3.6650618521368303`*^9}, {
  3.665062778095333*^9, 3.665062785703298*^9}, {3.6653363889656677`*^9, 
  3.665336390846902*^9}, {3.6653364544898777`*^9, 3.665336488679178*^9}, {
  3.6653371854664764`*^9, 3.6653371884058447`*^9}, {3.6653374814534597`*^9, 
  3.665337488958397*^9}, {3.6653386026899624`*^9, 3.6653386581349125`*^9}, {
  3.6653389902625637`*^9, 3.6653389975504446`*^9}, {3.6653402998956423`*^9, 
  3.6653403253398314`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", ",", "b"}], ")"}], " ", "=", " ", 
   RowBox[{
    SuperscriptBox["a", "T"], "b"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6650629594423513`*^9, 3.6650629892575293`*^9}, {
  3.665065494857188*^9, 3.665065513706177*^9}}]
},
WindowSize->{1350, 669},
WindowMargins->{{-2, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 157, 3, 31, "Input"],
Cell[718, 25, 260, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[1003, 33, 881, 18, 31, "Input"],
Cell[1887, 53, 1996, 32, 31, "Output"]
}, Open  ]],
Cell[3898, 88, 1725, 36, 172, "Input"],
Cell[5626, 126, 261, 7, 31, "Input"],
Cell[5890, 135, 861, 19, 42, "Input"],
Cell[6754, 156, 610, 14, 48, "Input"],
Cell[7367, 172, 594, 12, 31, "Input"],
Cell[7964, 186, 192, 4, 31, "Input"],
Cell[8159, 192, 764, 12, 31, "Input"],
Cell[8926, 206, 307, 8, 31, "Input"]
}
]
*)

(* End of internal cache information *)
