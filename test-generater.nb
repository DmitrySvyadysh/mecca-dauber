(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12317,        351]
NotebookOptionsPosition[     11076,        305]
NotebookOutlinePosition[     11454,        321]
CellTagsIndexPosition[     11411,        318]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData["\[Lambda]"], "Input"],

Cell[BoxData["\[Lambda]"], "Output",
 CellChangeTimes->{
  3.6650653872933683`*^9, 3.6650655154749217`*^9, {3.665065677899733*^9, 
   3.6650656918847756`*^9}, {3.6650673070772734`*^9, 
   3.6650673664208035`*^9}, {3.6650674063978786`*^9, 
   3.6650674720832157`*^9}, {3.6650675645759597`*^9, 3.6650675900031853`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\:041b", " ", ":=", " ", 
  RowBox[{"DiagonalMatrix", "[", "\[Lambda]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6563262683873444`*^9, 3.6563262727866635`*^9}, {
   3.6563263353455133`*^9, 3.6563263601108446`*^9}, 3.656327157821607*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"10", ",", "100"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665065869763241*^9, 3.665065943414589*^9}, {
   3.6650669702278137`*^9, 3.6650669839135475`*^9}, {3.6650670598189125`*^9, 
   3.665067076114956*^9}, {3.66506711696214*^9, 3.6650671513355045`*^9}, 
   3.6650672694474955`*^9, {3.6650674198015804`*^9, 3.6650674613988614`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"49", ",", "21", ",", "90"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"95", ",", "22", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "94", ",", "59"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.665067270180588*^9, 3.665067366487813*^9}, {
  3.6650674064528856`*^9, 3.6650674721462255`*^9}, {3.6650675647129745`*^9, 
  3.6650675903152237`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6650668697970657`*^9, 3.6650668729274597`*^9}}],

Cell[BoxData["49"], "Output",
 CellChangeTimes->{{3.665066873168496*^9, 3.6650668905396967`*^9}, {
  3.6650670622571964`*^9, 3.665067080938569*^9}, {3.665067128536609*^9, 
  3.6650671302868333`*^9}, {3.665067272716913*^9, 3.6650673664998145`*^9}, {
  3.665067406481889*^9, 3.6650674721622276`*^9}, {3.6650675647319765`*^9, 
  3.665067590330225*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lineSum", " ", ":=", " ", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lineSum", " ", "=", " ", 
       RowBox[{"lineSum", " ", "+", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], "]"}]}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"lineSum", " ", "+", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "100"}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6650659673256245`*^9, 3.665065976429784*^9}, {
  3.6650660690305347`*^9, 3.6650660775156116`*^9}, {3.6650662263475018`*^9, 
  3.6650662698120213`*^9}, {3.665066332155933*^9, 3.665066525989423*^9}, {
  3.665066557099374*^9, 3.665066607424759*^9}, {3.665066645780628*^9, 
  3.6650666702847395`*^9}, {3.6650673124389544`*^9, 3.6650673190697947`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["B"], "Input",
 CellChangeTimes->{3.665067297935112*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"196", ",", "21", ",", "90"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"95", ",", "210", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "94", ",", "252"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6650672994753065`*^9, 3.6650673665228167`*^9}, {
  3.6650674065048923`*^9, 3.66506747219123*^9}, {3.6650675647539797`*^9, 
  3.6650675903542285`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"B", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], ".", 
   RowBox[{"t", "[", "j", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "[", "i_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"B", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], " ", "-", " ", 
   RowBox[{
    SubsuperscriptBox["\[Sum]", 
     RowBox[{"j", "=", "1"}], 
     RowBox[{"i", "-", "1"}]], 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "*", 
     RowBox[{"t", "[", "j", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6650637385671196`*^9, 3.6650637448479156`*^9}, {
  3.665063906142393*^9, 3.6650639442312236`*^9}, {3.6650639853734493`*^9, 
  3.665064079078231*^9}, {3.6650641136386166`*^9, 3.665064152884598*^9}, {
  3.6650641970502415`*^9, 3.6650641996365323`*^9}, {3.6650642651458497`*^9, 
  3.665064266346002*^9}, {3.66506429825705*^9, 3.665064300874382*^9}, {
  3.6650645362862635`*^9, 3.665064542367062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "[", "i_", "]"}], " ", ":=", " ", 
  RowBox[{"N", "[", 
   FractionBox[
    RowBox[{"v", "[", "i", "]"}], 
    RowBox[{
     RowBox[{"v", "[", "i", "]"}], ".", 
     RowBox[{"v", "[", "i", "]"}]}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.665063670946538*^9, 3.665063701586426*^9}, {
  3.665063822283745*^9, 3.665063836710577*^9}, {3.665064490187413*^9, 
  3.6650645020829225`*^9}, {3.6650646258336325`*^9, 3.6650646306612434`*^9}}],

Cell[BoxData[
 RowBox[{"TT", " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"t", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6650646691643896`*^9, 3.665064674345045*^9}, {
   3.6650647670028057`*^9, 3.665064774222723*^9}, {3.6650648204345903`*^9, 
   3.6650648220958014`*^9}, {3.665064894248957*^9, 3.665064916049724*^9}, 
   3.6650649652069645`*^9}],

Cell[BoxData[
 RowBox[{"T", " ", ":=", " ", 
  RowBox[{"Transpose", "[", "TT", "]"}]}]], "Input",
 CellChangeTimes->{
  3.665064801676236*^9, {3.6650649698645573`*^9, 3.6650649752792425`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "T", "]"}]], "Input",
 CellChangeTimes->{{3.66506497815261*^9, 3.665064980009843*^9}, {
  3.665065442727231*^9, 3.6650654565804996`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.004054529281562235`", "0.00039339019331536857`", 
      "0.0012534684583553257`"},
     {"0.0019652055191245526`", "0.0039343039318481855`", 
      "0.00019494496095598092`"},
     {"0.0006205912165656482`", "0.0017610720785110991`", 
      "0.00350978880827846`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665064980553912*^9, 3.665065457034907*^9, 3.6650655155373664`*^9, {
   3.6650656779621315`*^9, 3.665065691993971*^9}, {3.665067307237294*^9, 
   3.6650673665918274`*^9}, {3.6650674065729027`*^9, 3.665067472244237*^9}, {
   3.6650675648309917`*^9, 3.6650675904152374`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"A", " ", ":=", " ", 
  RowBox[{"T", ".", "\:041b", ".", 
   RowBox[{"Transpose", "[", "T", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6563266383094206`*^9, 3.656326647265911*^9}, {
  3.6563267459803853`*^9, 3.6563267656218643`*^9}, {3.65632682143484*^9, 
  3.6563268265481167`*^9}, {3.6650618355106907`*^9, 3.6650618521368303`*^9}, {
  3.665062778095333*^9, 3.665062785703298*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.6563267699352417`*^9, 3.6563267755539284`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.004054529281562235`", ",", "0.00039339019331536857`", ",", 
       "0.0012534684583553257`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0019652055191245526`", ",", "0.0039343039318481855`", ",", 
       "0.00019494496095598092`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0006205912165656482`", ",", "0.0017610720785110991`", ",", 
       "0.00350978880827846`"}], "}"}]}], "}"}], ".", 
   RowBox[{"DiagonalMatrix", "[", "\[Lambda]", "]"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.004054529281562235`", ",", "0.0019652055191245526`", ",", 
       "0.0006205912165656482`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00039339019331536857`", ",", "0.0039343039318481855`", ",", 
       "0.0017610720785110991`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0012534684583553257`", ",", "0.00019494496095598092`", ",", 
       "0.00350978880827846`"}], "}"}]}], "}"}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.656326776567935*^9, 3.656326828857016*^9, 3.6563271638120728`*^9, 
   3.6563276138064413`*^9, 3.656328815909054*^9, 3.6650618557882633`*^9, {
   3.6650627718525405`*^9, 3.6650627880916014`*^9}, 3.665064190926427*^9, 
   3.6650643048678894`*^9, 3.665065474559979*^9, 3.6650655155685244`*^9, {
   3.6650656779776554`*^9, 3.6650656920408545`*^9}, {3.6650673072622957`*^9, 
   3.6650673666178303`*^9}, {3.6650674065989046`*^9, 3.665067433755351*^9}, 
   3.6650674722752466`*^9, {3.6650675648899975`*^9, 3.6650675904392395`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", ",", "b"}], ")"}], " ", "=", " ", 
   RowBox[{
    SuperscriptBox["a", "T"], "b"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6650629594423513`*^9, 3.6650629892575293`*^9}, {
  3.665065494857188*^9, 3.665065513706177*^9}}]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 35, 0, 36, "Input"],
Cell[618, 24, 317, 5, 36, "Output"]
}, Open  ]],
Cell[950, 32, 260, 4, 36, "Input"],
Cell[CellGroupData[{
Cell[1235, 40, 622, 14, 36, "Input"],
Cell[1860, 56, 441, 11, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2338, 72, 171, 4, 36, "Input"],
Cell[2512, 78, 349, 5, 36, "Output"]
}, Open  ]],
Cell[2876, 86, 1478, 32, 198, "Input"],
Cell[CellGroupData[{
Cell[4379, 122, 69, 1, 36, "Input"],
Cell[4451, 125, 445, 11, 36, "Output"]
}, Open  ]],
Cell[4911, 139, 261, 7, 36, "Input"],
Cell[5175, 148, 861, 19, 49, "Input"],
Cell[6039, 169, 472, 11, 57, "Input"],
Cell[6514, 182, 446, 10, 36, "Input"],
Cell[6963, 194, 192, 4, 36, "Input"],
Cell[CellGroupData[{
Cell[7180, 202, 179, 3, 36, "Input"],
Cell[7362, 207, 1123, 26, 90, "Output"]
}, Open  ]],
Cell[8500, 236, 405, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[8930, 247, 133, 2, 36, "Input"],
Cell[9066, 251, 1684, 41, 100, "Output"]
}, Open  ]],
Cell[10765, 295, 307, 8, 38, "Input"]
}
]
*)

(* End of internal cache information *)
